<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js"></script>


    <style type="text/css">
        /* The switch - the box around the slider */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        /* Hide default HTML checkbox */
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        /* The slider */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

        input:checked+.slider {
            background-color: #2196F3;
        }

        input:focus+.slider {
            box-shadow: 0 0 1px #2196F3;
        }

        input:checked+.slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }
    </style>

</head>

<body class="container-fluid">

    <div class="row mt-4">
        <div class="col-4">
            <div style=" display:flex; align-items: center; justify-content: center;">
                <label class="switch">
                    <input type="checkbox" id="hardware-switch-1">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="row">
                <div class="col-4" style="display: flex; flex-direction: column; justify-content: space-around;">
                    <img src="assets/ellipse.png" id="hardware-1-led-1" alt="img-led" width="61px" height="61px">
                    <img src="assets/ellipse.png" id="hardware-1-led-2" alt="img-led" width="61px" height="61px">
                </div>
                <div class="col-8">
                    <img src="assets/img1.png" alt="img1" width="201px" height="201px">
                </div>
            </div>
        </div>

        <div class="col-4">
            <div style=" display:flex; align-items: center; justify-content: center;">
                <label class="switch">
                    <input type="checkbox" id="hardware-switch-2">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="row">
                <div class="col-4" style="display: flex; flex-direction: column; justify-content: space-around;">
                    <img src="assets/ellipse.png" id="hardware-2-led-1" alt="img-led" width="61px" height="61px">
                    <img src="assets/ellipse.png" id="hardware-2-led-2" alt="img-led" width="61px" height="61px">
                </div>
                <div class="col-8">
                    <img src="assets/img2.png" alt="img2" width="201px" height="201px">
                </div>
            </div>
        </div>

        <div class="col-4">
            <div style=" display:flex; align-items: center; justify-content: center;">
                <label class="switch">
                    <input type="checkbox" id="hardware-switch-3">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="row">
                <div class="col-4" style="display: flex; flex-direction: column; justify-content: space-around;">
                    <img src="assets/ellipse.png" id="hardware-3-led-1" alt="img-led" width="61px" height="61px">
                    <img src="assets/ellipse.png" id="hardware-3-led-2" alt="img-led" width="61px" height="61px">
                </div>
                <div class="col-8">
                    <img src="assets/img3.png" alt="img3" width="201px" height="201px">
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-4">
            <div style=" display:flex; align-items: center; justify-content: center;">
                <label class="switch">
                    <input type="checkbox" id="hardware-switch-4">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="row">
                <div class="col-4" style="display: flex; flex-direction: column; justify-content: space-around;">
                    <img src="assets/ellipse.png" id="hardware-4-led-1" alt="img-led" width="61px" height="61px">
                    <img src="assets/ellipse.png" id="hardware-4-led-2" alt="img-led" width="61px" height="61px">
                </div>
                <div class="col-8">
                    <img src="assets/img4.png" alt="img4" width="201px" height="201px">
                </div>
            </div>
        </div>

        <div class="col-4">
            <div style=" display:flex; align-items: center; justify-content: center;">
                <label class="switch">
                    <input type="checkbox" id="hardware-switch-5">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="row">
                <div class="col-4" style="display: flex; flex-direction: column; justify-content: space-around;">
                    <img src="assets/ellipse.png" id="hardware-5-led-1" alt="img-led" width="61px" height="61px">
                    <img src="assets/ellipse.png" id="hardware-5-led-2" alt="img-led" width="61px" height="61px">
                </div>
                <div class="col-8">
                    <img src="assets/img5.png" alt="img5" width="201px" height="201px">
                </div>
            </div>
        </div>

        <div class="col-4">
            <div style=" display:flex; align-items: center; justify-content: center;">
                <label class="switch">
                    <input type="checkbox" id="hardware-switch-6">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="row">
                <div class="col-4" style="display: flex; flex-direction: column; justify-content: space-around;">
                    <img src="assets/ellipse.png" id="hardware-6-led-1" alt="img-led" width="61px" height="61px">
                    <img src="assets/ellipse.png" id="hardware-6-led-2" alt="img-led" width="61px" height="61px">
                </div>
                <div class="col-8">
                    <img src="assets/img6.png" alt="img6" width="201px" height="201px">
                </div>
            </div>
        </div>
    </div>

    <script>

        const defaultIntervalTimeInMillis = 200;

        let timerHardware1Led1 = null;
        let timerHardware1Led2 = null;
        let timerHardware2Led1 = null;
        let timerHardware2Led2 = null;
        let timerHardware3Led1 = null;
        let timerHardware3Led2 = null;
        let timerHardware4Led1 = null;
        let timerHardware4Led2 = null;
        let timerHardware5Led1 = null;
        let timerHardware5Led2 = null;
        let timerHardware6Led1 = null;
        let timerHardware6Led2 = null;

        $("#hardware-switch-1").change(function (value) {
            const active = value.currentTarget.checked;
            let led1 = $("#hardware-1-led-1");
            let led2 = $("#hardware-1-led-2");

            if (!active) {
                clearInterval(timerHardware1Led1);
                clearInterval(timerHardware1Led2);
                return;
            }

            timerHardware1Led1 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (status) led1.attr("src", "assets/ellipse-yellow.png");
                else led1.attr("src", "assets/ellipse.png");
                handleEvent(1, "led-1", status);
            }, defaultIntervalTimeInMillis);

            timerHardware1Led2 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (Math.random() < 0.5) led2.attr("src", "assets/ellipse-red.png");
                else led2.attr("src", "assets/ellipse.png");
                handleEvent(1, "led-2", status);
            }, defaultIntervalTimeInMillis);

        });

        $("#hardware-switch-2").change(function (value) {
            const active = value.currentTarget.checked;
            let led1 = $("#hardware-2-led-1");
            let led2 = $("#hardware-2-led-2");

            if (!active) {
                clearInterval(timerHardware2Led1);
                clearInterval(timerHardware2Led2);
                return;
            }

            timerHardware2Led1 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (status) led1.attr("src", "assets/ellipse-yellow.png");
                else led1.attr("src", "assets/ellipse.png");
                handleEvent(2, "led-1", status);
            }, defaultIntervalTimeInMillis);

            timerHardware2Led2 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (Math.random() < 0.5) led2.attr("src", "assets/ellipse-red.png");
                else led2.attr("src", "assets/ellipse.png");
                handleEvent(2, "led-2", status);
            }, defaultIntervalTimeInMillis);

        });

        $("#hardware-switch-3").change(function (value) {
            const active = value.currentTarget.checked;
            let led1 = $("#hardware-3-led-1");
            let led2 = $("#hardware-3-led-2");

            if (!active) {
                clearInterval(timerHardware3Led1);
                clearInterval(timerHardware3Led2);
                return;
            }

            timerHardware3Led1 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (status) led1.attr("src", "assets/ellipse-yellow.png");
                else led1.attr("src", "assets/ellipse.png");
                handleEvent(3, "led-1", status);
            }, defaultIntervalTimeInMillis);

            timerHardware3Led2 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (Math.random() < 0.5) led2.attr("src", "assets/ellipse-red.png");
                else led2.attr("src", "assets/ellipse.png");
                handleEvent(3, "led-2", status);
            }, defaultIntervalTimeInMillis);

        });

        $("#hardware-switch-4").change(function (value) {
            const active = value.currentTarget.checked;
            let led1 = $("#hardware-4-led-1");
            let led2 = $("#hardware-4-led-2");

            if (!active) {
                clearInterval(timerHardware4Led1);
                clearInterval(timerHardware4Led2);
                return;
            }

            timerHardware4Led1 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (status) led1.attr("src", "assets/ellipse-yellow.png");
                else led1.attr("src", "assets/ellipse.png");
                handleEvent(4, "led-1", status);
            }, defaultIntervalTimeInMillis);

            timerHardware4Led2 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (Math.random() < 0.5) led2.attr("src", "assets/ellipse-red.png");
                else led2.attr("src", "assets/ellipse.png");
                handleEvent(4, "led-2", status);
            }, defaultIntervalTimeInMillis);

        });

        $("#hardware-switch-5").change(function (value) {
            const active = value.currentTarget.checked;
            let led1 = $("#hardware-5-led-1");
            let led2 = $("#hardware-5-led-2");

            if (!active) {
                clearInterval(timerHardware5Led1);
                clearInterval(timerHardware5Led2);
                return;
            }

            timerHardware5Led1 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (status) led1.attr("src", "assets/ellipse-yellow.png");
                else led1.attr("src", "assets/ellipse.png");
                handleEvent(5, "led-1", status);
            }, defaultIntervalTimeInMillis);

            timerHardware5Led2 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (Math.random() < 0.5) led2.attr("src", "assets/ellipse-red.png");
                else led2.attr("src", "assets/ellipse.png");
                handleEvent(5, "led-2", status);
            }, defaultIntervalTimeInMillis);

        });

        $("#hardware-switch-6").change(function (value) {
            const active = value.currentTarget.checked;
            let led1 = $("#hardware-6-led-1");
            let led2 = $("#hardware-6-led-2");

            if (!active) {
                clearInterval(timerHardware6Led1);
                clearInterval(timerHardware6Led2);
                return;
            }

            timerHardware6Led1 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (status) led1.attr("src", "assets/ellipse-yellow.png");
                else led1.attr("src", "assets/ellipse.png");
                handleEvent(6, "led-1", status);
            }, defaultIntervalTimeInMillis);

            timerHardware6Led2 = setInterval(function () {
                const status = Math.random() < 0.5;
                if (Math.random() < 0.5) led2.attr("src", "assets/ellipse-red.png");
                else led2.attr("src", "assets/ellipse.png");
                handleEvent(6, "led-2", status);
            }, defaultIntervalTimeInMillis);

        });

        function handleEvent(hardwareId, componentId, data) {
            axios("http://localhost:8080/api/hardware-event",
                {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Access-Control-Allow-Origin': '*',
                        'Content-Type': 'application/json',
                    },
                    data: eventFactory(hardwareId, componentId, data),
                })
                .then(function (response) {
                    console.log(response)
                })
                .catch(function (err) {
                    console.log(err)
                });
        }

        function eventFactory(hardwareId, componentId, data) {
            return {
                hardwareId,
                componentId,
                slaveAddress: getRandHex(4),
                functionCode: parseInt(Math.random() * 10),
                data,
                crc: getRandHex(4)
            }
        }

        const getRandHex = size => {
            let result = [];
            let hexRef = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];

            for (let n = 0; n < size; n++) {
                result.push(hexRef[Math.floor(Math.random() * 16)]);
            }
            return result.join('');
        }

    </script>

</body>

</html>